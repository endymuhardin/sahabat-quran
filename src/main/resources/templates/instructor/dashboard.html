<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      layout:decorate="~{layouts/instructor-layout}">
<head>
    <title>Instructor Dashboard</title>
</head>
<body>
    <div layout:fragment="content">
        <div class="max-w-7xl mx-auto px-4 py-6">
            <div class="mb-8">
                <h1 class="text-3xl font-bold text-gray-900 mb-4">Dashboard Pengajar</h1>

                <!-- Welcome Message -->
                <div id="welcome-message" class="bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded mb-6">
                    <div class="flex items-center">
                        <i class="fas fa-info-circle mr-2"></i>
                        <div>
                            <h5 class="font-semibold">Selamat datang, <span sec:authentication="name">Ustadz Ahmad</span></h5>
                            <p class="text-sm mt-1">Akses kelas dan alat pelacakan progres Anda di bawah ini.</p>
                        </div>
                    </div>
                </div>

                <!-- Upcoming Session Alert (loaded via htmx) -->
                <div th:if="${hasUpcomingSession}"
                     th:replace="~{instructor/fragments :: upcoming-session-alert}"></div>

                <!-- Dashboard Stats (with htmx polling every 60 seconds) -->
                <div hx-get="/instructor/dashboard/stats"
                     hx-trigger="load, every 60s"
                     hx-swap="innerHTML"
                     id="stats-container">
                    <!-- Initial stats rendered server-side -->
                    <div th:replace="~{instructor/fragments :: dashboard-stats}"></div>
                </div>

                <!-- Quick Actions -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Kelas Saya Card -->
                    <div class="group instructor-card bg-white rounded-lg shadow-lg border border-gray-200 hover:shadow-xl transition-shadow duration-200">
                        <div class="p-6">
                            <div class="flex items-center mb-4">
                                <div class="bg-blue-100 p-3 rounded-full mr-4 transition-transform duration-200 group-hover:scale-110">
                                    <i class="fas fa-chalkboard text-2xl text-blue-600"></i>
                                </div>
                                <h5 class="text-xl font-semibold text-gray-900">Kelas Saya</h5>
                            </div>
                            <p class="text-gray-600 mb-4">Lihat kelas yang ditugaskan, kelola sesi, dan lacak kehadiran.</p>
                            <a href="/instructor/my-classes"
                               class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded transition-colors duration-200 inline-flex items-center">
                                <i class="fas fa-chalkboard mr-2"></i>
                                Kelas Saya
                            </a>
                        </div>
                    </div>

                    <!-- Progress Mingguan Card -->
                    <div class="group instructor-card bg-white rounded-lg shadow-lg border border-gray-200 hover:shadow-xl transition-shadow duration-200">
                        <div class="p-6">
                            <div class="flex items-center mb-4">
                                <div class="bg-green-100 p-3 rounded-full mr-4 transition-transform duration-200 group-hover:scale-110">
                                    <i class="fas fa-chart-line text-2xl text-green-600"></i>
                                </div>
                                <h5 class="text-xl font-semibold text-gray-900">Progress Mingguan</h5>
                            </div>
                            <p class="text-gray-600 mb-4">Catat progres siswa dan penilaian mingguan.</p>
                            <a href="/instructor/weekly-progress"
                               class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded transition-colors duration-200 inline-flex items-center">
                                <i class="fas fa-chart-line mr-2"></i>
                                Catat Progress
                            </a>
                        </div>
                    </div>

                    <!-- Kelola Sesi Card -->
                    <div class="group instructor-card bg-white rounded-lg shadow-lg border border-gray-200 hover:shadow-xl transition-shadow duration-200">
                        <div class="p-6">
                            <div class="flex items-center mb-4">
                                <div class="bg-purple-100 p-3 rounded-full mr-4 transition-transform duration-200 group-hover:scale-110">
                                    <i class="fas fa-calendar-alt text-2xl text-purple-600"></i>
                                </div>
                                <div class="flex items-center">
                                    <h5 class="text-xl font-semibold text-gray-900">Kelola Sesi</h5>
                                    <span th:if="${todaySessionCount > 0}"
                                          class="ml-2 px-2 py-1 bg-purple-100 text-purple-800 text-xs font-medium rounded-full"
                                          th:text="${todaySessionCount} + ' hari ini'">0 hari ini</span>
                                </div>
                            </div>
                            <p class="text-gray-600 mb-4">Kelola jadwal sesi, reschedule, dan atur substitusi.</p>
                            <a href="/instructor/session-management"
                               class="bg-purple-600 hover:bg-purple-700 text-white font-medium py-2 px-4 rounded transition-colors duration-200 inline-flex items-center">
                                <i class="fas fa-calendar-alt mr-2"></i>
                                Kelola Sesi
                            </a>
                        </div>
                    </div>

                    <!-- Persiapan Kelas Card -->
                    <div class="group instructor-card bg-white rounded-lg shadow-lg border border-gray-200 hover:shadow-xl transition-shadow duration-200">
                        <div class="p-6">
                            <div class="flex items-center mb-4">
                                <div class="bg-orange-100 p-3 rounded-full mr-4 transition-transform duration-200 group-hover:scale-110">
                                    <i class="fas fa-tasks text-2xl text-orange-600"></i>
                                </div>
                                <div class="flex items-center">
                                    <h5 class="text-xl font-semibold text-gray-900">Persiapan Kelas</h5>
                                    <span th:if="${pendingPreparationCount > 0}"
                                          class="ml-2 px-2 py-1 bg-orange-100 text-orange-800 text-xs font-medium rounded-full"
                                          th:text="${pendingPreparationCount} + ' pending'">0 pending</span>
                                </div>
                            </div>
                            <p class="text-gray-600 mb-4">Akses materi pembelajaran dan persiapan kelas.</p>
                            <a href="/instructor/class-preparation"
                               class="bg-orange-600 hover:bg-orange-700 text-white font-medium py-2 px-4 rounded transition-colors duration-200 inline-flex items-center">
                                <i class="fas fa-tasks mr-2"></i>
                                Persiapan
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Additional Quick Links -->
                <div class="mt-6 bg-white rounded-lg shadow p-4">
                    <h6 class="text-sm font-medium text-gray-500 mb-3">Akses Cepat</h6>
                    <div class="flex flex-wrap gap-2">
                        <a href="/instructor/availability-submission"
                           class="inline-flex items-center px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 text-sm rounded transition-colors duration-200">
                            <i class="fas fa-clock mr-1.5"></i>
                            Ketersediaan
                        </a>
                        <a href="/instructor/availability/change-requests"
                           class="inline-flex items-center px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 text-sm rounded transition-colors duration-200">
                            <i class="fas fa-exchange-alt mr-1.5"></i>
                            Permintaan Perubahan
                        </a>
                        <a href="/instructor/pre-closure-dashboard"
                           class="inline-flex items-center px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 text-sm rounded transition-colors duration-200">
                            <i class="fas fa-clipboard-check mr-1.5"></i>
                            Pre-Closure
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
